---
title: ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç†ï¼ˆå…„å¼Ÿè¿ï¼‰
date: 2022-08-04 14:34:43
tags:
categories:
- [å­¦ä¹ , DevOPS, å…„å¼Ÿè¿Linuxå­¦ä¹ ]
valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"
---

# ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç†

## ç”¨æˆ·é…ç½®æ–‡ä»¶

### ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶/etc/passwd

1. ç”¨æˆ·ç®¡ç†ç®€ä»‹
   - è¶Šæ˜¯å¯¹æœåŠ¡å™¨å®‰å…¨æ€§è¦æ±‚é«˜çš„æœåŠ¡å™¨ï¼Œè¶Šéœ€è¦å»ºç«‹åˆç†çš„ç”¨æˆ·æƒé™ç­‰çº§åˆ¶åº¦å’ŒæœåŠ¡å™¨æ“ä½œè§„èŒƒã€‚
   - åœ¨linuxä¸­ä¸»è¦é€šè¿‡ç”¨æˆ·é…ç½®æ–‡ä»¶æ¥æŸ¥çœ‹å’Œä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ã€‚

2. /etc/passwd
   > æ•´ä½“æ ¼å¼ï¼š`name:password:UID:GID:GECOS:directory:shell`

   ```bash
   [root@core-pods-3 ~]# man 5 passwd   # æŸ¥çœ‹é…ç½®æ–‡ä»¶è¯´æ˜
   # ï¼ˆ1ï¼‰nameï¼šç”¨æˆ·åç§°ï¼Œéç‰¹æ®Šå­—ç¬¦
   # ï¼ˆ2ï¼‰passwordï¼šå¯†ç æ ‡å¿—ï¼Œxä»£è¡¨è¯¥ç”¨æˆ·æœ‰å¯†ç ï¼Œå…·ä½“æŸ¥shadowæ–‡ä»¶ï¼›å¦‚æœxä¸å†™ä¼šé»˜è®¤è¯¥ç”¨æˆ·æ²¡å¯†ç å¹¶å¯ä»¥ç›´æ¥ç™»å½•ï¼ˆæ²¡æœ‰å¯†ç çš„ç™»å½•åªå…è®¸æœ¬æœºç™»å½•ï¼Œä¸å…è®¸è¿œç¨‹sshç™»å½•çš„ï¼Œæ‰€ä»¥ä¸ç”¨å¤ªæ‹…å¿ƒï¼‰
   # ï¼ˆ3ï¼‰UIDï¼šuser idï¼Œ
   #     - 0ï¼šè¶…çº§ç”¨æˆ·ï¼Œå¯ä»¥æ‰‹åŠ¨èµ‹äºˆä¸€ä¸ªæ™®é€šç”¨æˆ·çš„uidä¸º0ï¼Œæ­¤æ—¶è¯¥ç”¨æˆ·è¡Œä½¿å’ŒrootåŒæ ·çš„æƒé™ï¼›
   #     - 1-499æ˜¯ç³»ç»Ÿç”¨æˆ·ï¼Œä¸èƒ½åˆ ï¼Œåˆ é™¤å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒ
   #     - 500 - 65535ï¼šæ™®é€šç”¨æˆ·, å†…æ ¸2.6åæ”¯æŒ2çš„32æ¬¡æ–¹ç”¨æˆ·æ•°é‡
   # ï¼ˆ4ï¼‰GIDï¼šï¼ˆç”¨æˆ·åˆå§‹ç»„IDï¼‰
   #     - åˆå§‹ç»„ï¼šå°±æ˜¯æŒ‡ç”¨æˆ·ä¸€ç™»é™†å°±ç«‹åˆ»æ‹¥æœ‰è¿™ä¸ªç”¨æˆ·ç»„çš„ç›¸å…³æƒé™ï¼Œæ¯ä¸ªç”¨æˆ·çš„åˆå§‹ç»„åªèƒ½æœ‰ä¸€ä¸ªï¼Œä¸€èˆ¬å°±æ˜¯å’Œè¿™ä¸ªç”¨æˆ·çš„ç”¨æˆ·åç›¸åŒçš„ç»„åä½œä¸ºè¿™ä¸ªç”¨æˆ·çš„åˆå§‹ç»„ã€‚
   #     - é™„åŠ ç»„ï¼šæŒ‡ç”¨æˆ·å¯ä»¥åŠ å…¥å¤šä¸ªå…¶ä»–çš„ç”¨æˆ·ç»„ï¼Œå¹¶æ‹¥æœ‰è¿™äº›ç»„çš„æƒé™ï¼Œé™„åŠ ç»„å¯ä»¥æœ‰å¤šä¸ª
   # ï¼ˆ5ï¼‰ç”¨æˆ·è¯´æ˜ï¼Œå¤‡æ³¨ï¼Œå¯ä»¥ä¸åŠ 
   # ï¼ˆ6ï¼‰å®¶ç›®å½•ï¼ˆå®¿ä¸»ç›®å½•ï¼‰
   #     - æ™®é€šç”¨æˆ·ï¼š/home/ç”¨æˆ·å/
   #     - è¶…çº§ç”¨æˆ·ï¼š/root/
   #  (7) ç™»å½•ä¹‹åçš„shellï¼Œshellå°±æ˜¯linuxçš„å‘½ä»¤è§£é‡Šå™¨ï¼Œåœ¨/etc/passwdå½“ä¸­ï¼Œé™¤äº†æ ‡å‡†shellæ˜¯/bin/bashä¹‹å¤–ï¼Œè¿˜å¯ä»¥å†™å¦‚/sbin/nologinï¼Œä½†æ˜¯ä¸èƒ½å†™é”™ï¼Œå†™é”™æ˜¯ç™»å½•ä¸äº†çš„
   [root@core-pods-3 ~]# vim /etc/passwd
   root:x:0:0:root:/root:/bin/bash
   bin:x:1:1:bin:/bin:/sbin/nologin
   daemon:x:2:2:daemon:/sbin:/sbin/nologin
   ... ...
   [root@core-pods-3 ~]# 

   # linuxä¸€å¼€å§‹å¯†ç å°±æ”¾åœ¨passwdä¸‹é¢ï¼Œåæ¥å¯†ç æ”¾åœ¨äº†/etc/shadwowä¸‹ï¼Œllå¯ä»¥æŸ¥çœ‹åˆ°shadowæ–‡ä»¶æ²¡æœ‰ä»»ä½•æ“ä½œæƒé™
   [root@core-pods-3 ~]# ll /etc/passwd
   -rw-r--r-- 1 root root 1785 Aug  4 04:14 /etc/passwd
   [root@core-pods-3 ~]# ll /etc/shadow
   ---------- 1 root root 2161 Aug  4 04:14 /etc/shadow
   [root@core-pods-3 ~]#  vim /etc/shadow   # å¯ä»¥çœ‹åˆ°å¯†ç ä»¥éæ˜æ–‡æ–¹å¼è®°å½•ï¼Œåªæœ‰rootå¯ä»¥æŸ¥çœ‹
   ```

3. å½±å­æ–‡ä»¶ï¼š/etc/shadow

   ```bash
   #ï¼ˆ1ï¼‰rootï¼šç”¨æˆ·å
   #ï¼ˆ2ï¼‰$6$2...ï¼šåŠ å¯†åçš„å¯†ç ï¼Œmd5 -> sha512ï¼Œå¦‚æœå¯†ç ä½æ˜¯"!!"æˆ–"*"ï¼Œä»£è¡¨æ²¡æœ‰å¯†ç ï¼Œä¸èƒ½ç™»å½•
   #ï¼ˆ3ï¼‰19174ï¼šå¯†ç æœ€åä¸€æ¬¡ä¿®æ”¹æ—¥æœŸï¼šä½¿ç”¨1970å¹´1æœˆ1æ—¥ä½œä¸ºæ ‡å‡†æ—¶é—´ï¼Œæ¯è¿‡ä¸€å¤©æ—¶é—´æˆ³+1ï¼Œè¿™é‡ŒæŒ‡1970å¹´1æœˆ1æ—¥åçš„ç¬¬19174å¤©
   #ï¼ˆ4ï¼‰0ï¼šæŒ‡ä»ç¬¬19174å¤©å¼€å§‹ï¼Œä»»ä½•æ—¶é—´éƒ½å¯ä»¥ä¿®æ”¹å¯†ç ï¼Œå¦‚æœæ˜¯10çš„è¯æ„æ€å°±æ˜¯10å¤©å†…ä¸èƒ½ä¿®æ”¹å¯†ç ï¼Œæ‰€ä»¥è¿™ä¸ªå­—æ®µæŒ‡ä¸¤æ¬¡å¯†ç çš„ä¿®æ”¹é—´éš”æ—¶é—´
   #ï¼ˆ5ï¼‰99999ï¼šå¯†ç çš„æœ‰æ•ˆæœŸï¼Œå³19174 + 99999
   #ï¼ˆ6ï¼‰7ï¼šå¯†ç ä¿®æ”¹åˆ°æœŸå‰çš„è­¦å‘Šå¤©æ•°ï¼ˆå’Œç¬¬äº”ä¸ªå­—æ®µç›¸æ¯”ï¼‰
   #ï¼ˆ7ï¼‰ç©ºï¼šå¯†ç è¿‡æœŸåçš„å®½é™å¤©æ•°ï¼ˆå’Œç¬¬äº”ä¸ªå­—æ®µç›¸æ¯”ï¼‰
   #    - 0ï¼šä»£è¡¨å¯†ç è¿‡æœŸåç«‹å³å¤±æ•ˆï¼Œå†™0å’Œä¸å†™æ˜¯ä¸€ä¸ªæ„æ€ï¼Œæ‰€ä»¥ç©ºæ„å‘³ç€åˆ°æœŸå³å¤±æ•ˆ
   #    - -1ï¼šä»£è¡¨å¯†ç æ°¸è¿œä¸ä¼šå¤±æ•ˆ
   #ï¼ˆ8ï¼‰ç©ºï¼šè´¦å·å¤±æ•ˆæ—¶é—´ï¼Œè¦ç”¨æ—¶é—´æˆ³è¡¨ç¤º
   #ï¼ˆ9ï¼‰ç©ºï¼šä¿ç•™
   [root@core-pods-3 ~]# vi /etc/shadow
   root:$6$2cP08Sf/$/rH6Zw6my.hemDc8/5TDpVfS2an3Hho.HyVU4qYN3d7CMxn0d1zzAHVxrvfzOJBoxWJaaDR.lKkis4iMjO0:19174:0:99999:7:::
   bin:*:17110:0:99999:7:::
   daemon:*:17110:0:99999:7:::
   adm:*:17110:0:99999:7:::
   ... ...
   user1:!!:19205:0:99999:7:::
   user2:!!:19205:0:99999:7:::
   user3:!!:19205:0:99999:7:::

   # æ—¶é—´æˆ³æ¢ç®—
   [root@core-pods-3 ~]# date -d "1970-01-01 16066 days"
   Fri Dec 27 00:00:00 EST 2013
   [root@core-pods-3 ~]# echo $(($(date --date="2014/01/06" +%s)/86400+1))
   16077
   ```

3. ç»„ä¿¡æ¯æ–‡ä»¶
   > ç»„ä¿¡æ¯æ–‡ä»¶ï¼š/etc/group
   >
   > ç»„å¯†ç æ–‡ä»¶ï¼š/etc/gshadow

   ```bash
   # /etc/group
   # 
   # æ€»å…±æœ‰4ä¸ªå­—æ®µï¼šç»„åã€ç»„çš„å¯†ç æ ‡å¿—ã€GIDã€ç»„ä¸­é™„åŠ ç”¨æˆ·
   # ç¬¬ä¸€å­—æ®µ-ç»„åï¼šé»˜è®¤å°±æ˜¯å’Œç”¨æˆ·åä¸€æ ·,linuxæ¯æ·»åŠ ä¸€ä¸ªç”¨æˆ·ä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ªåŒåçš„ç”¨æˆ·ç»„
   # ç¬¬äºŒå­—æ®µ-ç»„å¯†ç ï¼šä¸æ¨èä½¿ç”¨ç»„å¯†ç ï¼Œè®¾äº†ç»„å¯†ç å¯èƒ½ä¼šè¡Œä½¿rootéƒ¨åˆ†æƒé™ï¼Œä¼šé™ä½ç³»ç»Ÿå®‰å…¨æ€§
   # ç¬¬ä¸‰å­—æ®µ-GIDï¼šgroup idï¼Œç»„idï¼Œå¯ä»¥å¼ºåˆ¶ä¿®æ”¹ç»„idï¼Œæ¯”å¦‚æ”¹æˆå’Œrootä¸€æ ·çš„idè¡Œä½¿å’Œrootä¸€æ ·çš„æƒé™
   # ç¬¬å››å­—æ®µ-é™„åŠ ç”¨æˆ·ï¼šåªèƒ½çœ‹åˆ°é™„åŠ ç”¨æˆ·ï¼Œçœ‹ä¸åˆ°åˆå§‹ç”¨æˆ·ï¼ˆæŸ¥çœ‹åˆå§‹ç”¨æˆ·éœ€è¦å‚ç…§/etc/passwdï¼‰
   [root@core-pods-3 ~]# vim /etc/group
   root:x:0:
   bin:x:1:
   daemon:x:2:
   sys:x:3:
   ... ...
   Bella3:x:1011:
   Bella4:x:1012:
   Bella5:x:1013:
   ```

   ```bash
   # /etc/gshadow

   # ç¬¬ä¸€å­—æ®µï¼šç»„åã€‚
   # ç¬¬äºŒå­—æ®µï¼šç»„å¯†ç ã€‚
   # ç¬¬ä¸‰å­—æ®µï¼šç»„ç®¡ç†å‘˜ç”¨æˆ·åã€‚
   # ç¬¬å››å­—æ®µï¼šç»„ä¸­é™„åŠ ç”¨æˆ·ã€‚
   [root@core-pods-3 ~]# vim /etc/gshadow
   root:::
   bin:::
   daemon:::
   sys:::
   ... ...
   Bella3:!::
   Bella4:!::
   Bella5:!::
   ```

## ç”¨æˆ·ç®¡ç†ç›¸å…³æ–‡ä»¶
1. ç”¨æˆ·çš„å®¶ç›®å½•
   - æ™®é€šç”¨æˆ·ï¼š/home/ç”¨æˆ·å/ï¼Œæ‰€æœ‰è€…å’Œæ‰€å±ç»„éƒ½æ˜¯æ­¤ç”¨æˆ·ï¼Œæƒé™æ˜¯700ã€‚
   - è¶…çº§ç”¨æˆ·ï¼š/root/ï¼Œæ‰€æœ‰è€…å’Œæ‰€å±ç»„éƒ½æ˜¯rootç”¨æˆ·ï¼Œæƒé™æ˜¯550ã€‚
   ```bash
   [root@core-pods-3 ~]# ll -d /root/
   dr-xr-x---. 6 root root 4096 Aug  8 22:22 /root/
   [root@core-pods-3 ~]# ll -d /home/Jalen1
   drwx------ 2 Jalen1 Jalen1 4096 Aug  4 04:09 /home/Jalen1
   ```

   > æ€ä¹ˆæŠŠä¸€ä¸ªæ™®é€šç”¨æˆ·å˜ä¸ºè¶…çº§ç”¨æˆ·ï¼Ÿ
   > 
   > ç­”æ¡ˆï¼šå°†/etc/passwdä¸‹çš„uidæ”¹ä¸º0ï¼Œå’Œrootä¸€æ ·å³å¯ï¼Œæ­¤æ—¶å®ƒçš„å®¶ç›®å½•ä¸ä¼šæ›´æ”¹ï¼Œåªæ˜¯ç™»å½•åä¸åœ¨æ˜¯$ç¬¦å·è€Œæ˜¯#å·ï¼Œä¹Ÿå°±æ˜¯æƒé™æ›´æ”¹äº†ä½†æ˜¯å®¶ç›®å½•ä¸å˜ã€‚

2. ç”¨æˆ·çš„é‚®ç®±
   è¿™é‡Œçš„é‚®ç®±åªæ˜¯å®¢æˆ·ç«¯ï¼Œå¹¶æ²¡æœ‰é‚®ä»¶æœåŠ¡å™¨ï¼ˆç±»ä¼¼qqé‚®ç®±ï¼‰ï¼Œè¿™é‡Œåªlinuxç”¨æˆ·ä¹‹é—´å‘é€é‚®ä»¶ï¼Œåˆ©ç”¨çš„æ˜¯å†…å­˜ç®¡ç†ï¼Œè™½ç„¶æ¯ä¸ªç”¨æˆ·éƒ½æœ‰é‚®ç®±(æ¯ä¸ªç”¨æˆ·éƒ½ä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ªé‚®ç®±ï¼Œåå­—å’Œç”¨æˆ·åä¸€æ ·)ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰é‚®ä»¶æœåŠ¡å™¨ï¼Œé‚®ç®±è·¯å¾„æ˜¯`/var/spool/mail/ç”¨æˆ·å/`ã€‚varæ˜¯linuxç³»ç»Ÿä¸­å¯å˜æ•°æ®ä¿å­˜ä½ç½®ã€‚
   ```bash
   [root@core-pods-3 ~]# ll /var/spool/mail/
   total 4
   -rw-rw---- 1 Bella1     mail   0 Aug  4 04:14 Bella1
   -rw-rw---- 1 Bella2     mail   0 Aug  4 04:14 Bella2
   -rw-rw---- 1 Bella3     mail   0 Aug  4 04:14 Bella3
   -rw-rw---- 1 Bella4     mail   0 Aug  4 04:14 Bella4
   -rw-rw---- 1 Bella5     mail   0 Aug  4 04:14 Bella5
   -rw-rw---- 1 Jalen1     mail   0 Aug  4 04:09 Jalen1
   -rw-rw---- 1 Jalen2     mail   0 Aug  4 04:09 Jalen2
   -rw-rw---- 1 Jalen3     mail   0 Aug  4 04:09 Jalen3
   -rw-rw---- 1 Jalen4     mail   0 Aug  4 04:09 Jalen4
   -rw-rw---- 1 Jalen5     mail   0 Aug  4 04:09 Jalen5
   -rw-rw---- 1 linzhiling mail   0 Jul 15 22:27 linzhiling
   -rw------- 1 root       mail 628 Jul 17 22:39 root
   -rw-rw---- 1 user1      mail   0 Aug  1 00:21 user1
   -rw-rw---- 1 user2      mail   0 Aug  1 00:21 user2
   -rw-rw---- 1 user3      mail   0 Aug  1 00:21 user3
   [root@core-pods-3 ~]# 
   ```

3. ç”¨æˆ·æ¨¡æ¿ç›®å½•
   ç›®å½•ä¸º`/etc/skel`ã€‚åœ¨è¿™ä¸ªç›®å½•ä¸‹å¯ä»¥å†™ä¸€äº›è¯´æ˜ä¿¡æ¯ï¼Œè¿™æ ·åœ¨æ–°ç”¨æˆ·æ·»åŠ åï¼Œè¿™äº›è§„åˆ™æ€§çš„æ–‡ä»¶æˆ–è¯´æ˜ä¼šè‡ªåŠ¨åˆ›å»ºåœ¨è¿™ä¸ªæ–°ç”¨æˆ·çš„å®¶ç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ˜¯å®¶ç›®å½•ä¸‹ä¼šæ ¹æ®è¿™ä¸ªæ¨¡æ¿å»ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`ls -a`æŸ¥çœ‹ä¸‹è¿™ä¸ªç›®å½•ï¼Œèƒ½å¤Ÿå‘ç°æœ‰å¾ˆå¤šç”¨æˆ·é…ç½®æ–‡ä»¶æ¯”å¦‚`.bash_profile`å’Œ`.bashrc`éƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚
   ```bash
   [root@core-pods-3 ~]# cd /home/Jalen1
   [root@core-pods-3 Jalen1]# ls
   [root@core-pods-3 Jalen1]# ls -a
   .  ..  .bash_logout  .bash_profile  .bashrc
   [root@core-pods-3 Jalen1]# ll /etc/skel/
   total 0
   [root@core-pods-3 Jalen1]# cd /etc/skel/
   [root@core-pods-3 skel]# vi warning.txt   # éšä¾¿å†™ç‚¹
   [root@core-pods-3 skel]# ls
   warning.txt
   [root@core-pods-3 skel]# ls -a
   .  ..  .bash_logout  .bash_profile  .bashrc  warning.txt
   [root@core-pods-3 skel]# useradd superman
   [root@core-pods-3 skel]# passwd superman
   Changing password for user superman.
   New password: 
   BAD PASSWORD: The password is shorter than 8 characters
   Retype new password: 
   passwd: all authentication tokens updated successfully.
   [root@core-pods-3 skel]# cd /home/superman/
   [root@core-pods-3 superman]# ls -a
   .  ..  .bash_logout  .bash_profile  .bashrc  warning.txt
   [root@core-pods-3 superman]# cat warning.txt 
   Please follow the rules.
   ```

## ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç†

1. ç”¨æˆ·æ·»åŠ å‘½ä»¤useradd

   å‘½ä»¤`# useradd [é€‰é¡¹] ç”¨æˆ·å`ï¼Œé€‰é¡¹ï¼š
   - -u UIDï¼šæ‰‹å·¥æŒ‡å®šç”¨æˆ·çš„UIDå·ã€‚ä¸å»ºè®®æ‰‹åŠ¨æŒ‡å®š
   - -d å®¶ç›®å½•ï¼šæ‰‹å·¥æŒ‡å®šç”¨æˆ·çš„å®¶ç›®å½•ã€‚ä¸æ¨è
   - -c ç”¨æˆ·è¯´æ˜ï¼šæ‰‹å·¥æŒ‡å®šç”¨æˆ·çš„è¯´æ˜ã€‚
   - -g ç»„åï¼šæ‰‹å·¥æŒ‡å®šç”¨æˆ·çš„åˆå§‹ç»„
   - -G ç»„åï¼šæŒ‡å®šç”¨æˆ·çš„é™„åŠ ç»„
   - -s shellï¼šæ‰‹å·¥æŒ‡å®šç”¨æˆ·çš„ç™»å½•shellã€‚é»˜è®¤æ˜¯`/bin/bash`
   ```bash
   [root@core-pods-3 ~]# useradd jalen
   [root@core-pods-3 ~]# passwd jalen
   Changing password for user jalen.
   New password: 
   Retype new password: 
   passwd: all authentication tokens updated successfully.
   [root@core-pods-3 ~]# grep jalen /etc/passwd
   jalen:x:1015:1015::/home/jalen:/bin/bash
   [root@core-pods-3 ~]# grep jalen /etc/shadow
   jalen:$6$YfI2Q0.f$8yPh9s7e7jmAE1ifpvyc3LdEyZqVY/tTKGKZPDlYYRS90lEmINh.FdXssa87c4f/s3NEz9wqkNt..aypD1.:19213:0:99999:7:::
   [root@core-pods-3 ~]# grep jalen /etc/group
   jalen:x:1015:
   [root@core-pods-3 ~]# grep jalen /etc/gshadow
   jalen:!::
   [root@core-pods-3 ~]# ll -d /home/
   drwxr-xr-x. 18 root root 4096 Aug  8 23:15 /home/
   [root@core-pods-3 ~]# ll -d /home/jalen/
   drwx------ 2 jalen jalen 4096 Aug  8 23:15 /home/jalen/
   [root@core-pods-3 ~]# ll /var/spool/mail/jalen 
   -rw-rw---- 1 jalen mail 0 Aug  8 23:15 /var/spool/mail/jalen
   [root@core-pods-3 ~]# 
   ```

   ```bash
   [root@core-pods-3 ~]# useradd -u 550 -G root,bin -d /home/jjj -c "test user jjj" -s /bin/bash kkk
   [root@core-pods-3 ~]# grep kkk /etc/passwd
   kkk:x:550:1016:test user jjj:/home/jjj:/bin/bash
   [root@core-pods-3 ~]# ll -d /home/jjj
   drwx------ 2 kkk kkk 4096 Aug  9 00:10 /home/jjj
   [root@core-pods-3 ~]# 
   ```

2. ç”¨æˆ·é»˜è®¤å€¼æ–‡ä»¶

   > /etc/default/useradd

   - GROUP=100ï¼šç”¨æˆ·é»˜è®¤ç»„
   - HOME=/homeï¼šç”¨æˆ·å®¶ç›®å½•
   - INACTIVE=-1ï¼šå¯†ç è¿‡æœŸå®½é™å¤©æ•°ï¼ˆshadowæ–‡ä»¶7å­—æ®µï¼‰
   - EXPIRE=ï¼šå¯†ç å¤±æ•ˆæ—¶é—´ï¼ˆshadowæ–‡ä»¶8å­—æ®µï¼‰
   - SHELL=/bin/bashï¼šé»˜è®¤shell
   - SKEL=/etc/skelï¼šæ¨¡æ¿ç›®å½•
   - CREATE_MAIL_SPOOL=yesï¼šæ˜¯å¦å»ºç«‹é‚®ç®±

   ```bash
   [root@core-pods-3 ~]# vi /etc/default/useradd 
   # useradd defaults file
   GROUP=100
   HOME=/home
   INACTIVE=-1
   EXPIRE=
   SHELL=/bin/bash
   SKEL=/etc/skel
   CREATE_MAIL_SPOOL=yes
   ```

   > /etc/login.defs

   - PASS_MAX_DAYS 99999ï¼šå¯†ç æœ‰æ•ˆæœŸï¼ˆshadowæ–‡ä»¶çš„ç¬¬äº”ä¸ªå­—æ®µï¼‰
   - PASS_MIN_DAYS 0ï¼šå¯†ç ä¿®æ”¹é—´éš”ï¼ˆshadowæ–‡ä»¶çš„ç¬¬å››ä¸ªå­—æ®µï¼‰
   - PASS_MIN_LEN 5ï¼šå¯†ç æœ€å°‘5ä½ï¼ˆç°åœ¨PAMç”Ÿæ•ˆï¼Œè¿™ä¸ªå±æ€§ä¸ç”Ÿæ•ˆäº†ï¼Œè¦æ±‚æœ€ä½8ä½ï¼‰
   - PASS_WARN_AGE 7ï¼šå¯†ç åˆ°æœŸè­¦å‘Šï¼ˆshadowæ–‡ä»¶çš„ç¬¬å…­ä¸ªå­—æ®µï¼‰
   - UID_MIN 500ï¼šæœ€å°å’Œæœ€å¤§UIDèŒƒå›´
   - GID_MAX 60000
   - ENCRYPT_METHOD SHA512ï¼šåŠ å¯†æ¨¡å¼

   ```bash
   [root@core-pods-3 ~]# vi /etc/login.defs 
   MAIL_DIR        /var/spool/mail

   PASS_MAX_DAYS   99999
   PASS_MIN_DAYS   0
   PASS_MIN_LEN    5
   PASS_WARN_AGE   7

   UID_MIN                  1000
   UID_MAX                 60000
   SYS_UID_MIN               201
   SYS_UID_MAX               999

   GID_MIN                  1000
   GID_MAX                 60000
   SYS_GID_MIN               201
   SYS_GID_MAX               999

   CREATE_HOME     yes
   UMASK           077
   USERGROUPS_ENAB yes
   ENCRYPT_METHOD SHA512
   ```

3. ä¿®æ”¹ç”¨æˆ·å¯†ç passwd

   å‘½ä»¤æ ¼å¼`# passwd [é€‰é¡¹] ç”¨æˆ·å`ï¼Œé€‰é¡¹ï¼š
   - -Sï¼šæŸ¥è¯¢ç”¨æˆ·å¯†ç çš„å¯†ç çŠ¶æ€ã€‚ä»…rootç”¨æˆ·å¯ç”¨ã€‚
   - -lï¼šæš‚æ—¶é”å®šç”¨æˆ·ã€‚ä½¿è¯¥ç”¨æˆ·æš‚æ—¶ä¸èƒ½ç™»å…¥ï¼Œä»…rootç”¨æˆ·å¯ç”¨ã€‚ï¼ˆå…¶å®æ˜¯åœ¨/etc/shadowé‡Œå¯†ç å‰åŠ äº†ä¸€ä¸ªæ„Ÿå¹å·ï¼‰
   - -uï¼šè§£é”ç”¨æˆ·ã€‚ä»…rootç”¨æˆ·å¯ç”¨ã€‚
   - --stdinï¼šå¯ä»¥é€šè¿‡ç®¡é“ç¬¦è¾“å‡ºçš„æ•°æ®ä½œä¸ºç”¨æˆ·çš„å¯†ç ã€‚

   ```bash
   [root@core-pods-3 ~]# passwd kkk
   Changing password for user kkk.
   New password: 
   BAD PASSWORD: The password is shorter than 8 characters
   Retype new password: 
   passwd: all authentication tokens updated successfully.
   [root@core-pods-3 ~]# passwd      # ä¸åŠ ç”¨æˆ·åé»˜è®¤ä¿®æ”¹å½“å‰ç™»å½•ç”¨æˆ·çš„å¯†ç 
   Changing password for user root.
   New password: 
   [root@core-pods-3 ~]# passwd -S kkk   # æŸ¥çœ‹å¯†ç çŠ¶æ€ ï¼ˆå¯¹æ¯”shadowçœ‹ï¼‰
   # ç”¨æˆ·åï¼Œå¯†ç è®¾å®šæ—¶é—´ï¼Œå¯†ç ä¿®æ”¹æ—¶é—´é—´éš”ï¼Œå¯†ç æœ‰æ•ˆæœŸï¼Œè­¦å‘Šæ—¶é—´ï¼Œå¯†ç ä¸å¤±æ•ˆ-1
   kkk PS 2022-08-08 0 99999 7 -1 (Password set, SHA512 crypt.)
   [root@core-pods-3 ~]# cat /etc/shadow | grep kkk
   kkk:$6$OLQqCgMg$wAAR686.a9PQs0gJDRiswjV5S.1sQ4oWS9Cum.owam9orBcZCfQjx6/UaaZHFnlh96wyfCZwF1RpjjRog60:19213:0:99999:7:::
   [root@core-pods-3 ~]# echo "123" | passwd --stdin kkk
   Changing password for user kkk.
   passwd: all authentication tokens updated successfully.
   ```

4. ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯usermodå’Œä¿®æ”¹ç”¨æˆ·å¯†ç çŠ¶æ€chage

   å‘½ä»¤`# usermod [é€‰é¡¹] ç”¨æˆ·å`ï¼Œé€‰é¡¹ï¼š
   - -u UIDï¼šä¿®æ”¹ç”¨æˆ·çš„UIDå·
   - -c ç”¨æˆ·è¯´æ˜ï¼šä¿®æ”¹ç”¨æˆ·çš„è¯´æ˜ä¿¡æ¯
   - -G ç»„åï¼šä¿®æ”¹ç”¨æˆ·çš„é™„åŠ ç»„
   - -Lï¼šä¸´æ—¶é”å®šç”¨æˆ·lock
   - -Uï¼šè§£é”ç”¨æˆ·é”å®šunlock

   å‘½ä»¤`# chage [é€‰é¡¹] ç”¨æˆ·å`ï¼Œé€‰é¡¹ï¼š
   - -lï¼šåˆ—å‡ºç”¨æˆ·çš„è¯¦ç»†å¯†ç çŠ¶æ€
   - -d æ—¥æœŸï¼šä¿®æ”¹å¯†ç æœ€åä¸€æ¬¡æ›´æ”¹æ—¥æœŸï¼ˆshadow 3 å­—æ®µï¼‰
   - -m å¤©æ•°ï¼šä¸¤æ¬¡å¯†ç ä¿®æ”¹é—´éš”ï¼ˆ4å­—æ®µï¼‰
   - -M å¤©æ•°ï¼šå¯†ç æœ‰æ•ˆæœŸï¼ˆ5å­—æ®µï¼‰
   - -W å¤©æ•°ï¼šå¯†ç è¿‡æœŸå‰è­¦å‘Šå¤©æ•°ï¼ˆ6å­—æ®µï¼‰
   - -I å¤©æ•°ï¼šå¯†ç è¿‡æœŸåå®½é™å¤©æ•°ï¼ˆ7å­—æ®µï¼‰
   - -E æ—¥æœŸï¼šè´¦å·å¤±æ•ˆæ—¶é—´ï¼ˆ8å­—æ®µï¼‰

   ```bash
   [root@core-pods-3 ~]# chage -l kkk
   Last password change                                    : Aug 09, 2022
   Password expires                                        : never
   Password inactive                                       : never
   Account expires                                         : never
   Minimum number of days between password change          : 0
   Maximum number of days between password change          : 99999
   Number of days of warning before password expires       : 7
   [root@core-pods-3 ~]# chage -d 0 kkk
   # è¿™ä¸ªå‘½ä»¤å…¶å®æ˜¯æŠŠå¯†ç ä¿®æ”¹æ—¥æœŸå½’0äº†ï¼ˆshadowç¬¬ä¸‰å­—æ®µï¼‰ï¼Œè¿™æ ·ç”¨æˆ·ä¸€ç™»é™†å°±è¦ä¿®æ”¹å¯†ç 
   [root@core-pods-3 ~]# grep kkk /etc/shadow
   kkk:$6$9.3inrrJ$wSy.U1PsX6idF4J8KkDo7Uru5Q26hgEX3sY174jLdFphZG2FCi6cfCVON2eOMLSZ3JvgCE2i46vJMTDCcz.:0:0:99999:7:::

   ## ä½¿ç”¨kkkç™»å½•ç›´æ¥è®©ä½ æ”¹å¯†ç 
   You are required to change your password immediately (root enforced)
   Warning: I am a policeman, will catch you!
   WARNING: Your password has expired.
   You must change your password now and login again!
   Changing password for user kkk.
   Changing password for kkk.
   (current) UNIX password: 
   ```

5. åˆ é™¤ç”¨æˆ·userdelå’Œç”¨æˆ·åˆ‡æ¢å‘½ä»¤su

- åˆ é™¤ç”¨æˆ·userdelï¼š`userdel [-r] ç”¨æˆ·å`ï¼Œ-ræ„æ€æ˜¯åˆ é™¤ç”¨æˆ·çš„åŒæ—¶åˆ é™¤ç”¨æˆ·å®¶ç›®å½•
- æ‰‹å·¥åˆ é™¤ç”¨æˆ·ï¼š
  ```bash
  [root@core-pods-3 ~]# vi /etc/passwd
  [root@core-pods-3 ~]# vi /etc/shadow
  [root@core-pods-3 ~]# vi /etc/group
  [root@core-pods-3 ~]# vi /etc/gshadow
  [root@core-pods-3 ~]# rm -rf /home/kkk
  [root@core-pods-3 ~]# rm -rf /var/spool/mail/kkk
  ```
- æŸ¥çœ‹ç”¨æˆ·IDï¼š`id ç”¨æˆ·å`
  ```bash
  [root@core-pods-3 ~]# id root
  uid=0(root) gid=0(root) groups=0(root)
  [root@core-pods-3 ~]# id kkk
  uid=550(kkk) gid=1016(kkk) groups=1016(kkk),0(root),1(bin)
  [root@core-pods-3 ~]# 
  ```
- åˆ‡æ¢ç”¨æˆ·èº«ä»½suï¼š`su [é€‰é¡¹] ç”¨æˆ·å`ï¼Œé€‰é¡¹
  - -ï¼šé€‰é¡¹åªä½¿ç”¨â€œ-â€ä»£è¡¨è¿å¸¦ç”¨æˆ·çš„ç¯å¢ƒå˜é‡ä¸€èµ·åˆ‡æ¢
  - -c å‘½ä»¤ï¼šä»…æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ï¼Œè€Œä¸åˆ‡æ¢ç”¨æˆ·èº«ä»½
  ```bash
  [root@core-pods-3 ~]$ su - root
  [root@core-pods-3 ~]$ su - root -c "useradd user3"
  ```

## ç”¨æˆ·ç»„ç®¡ç†

1. æ·»åŠ ç”¨æˆ·ç»„ï¼š`groupadd [é€‰é¡¹] ç”¨æˆ·ç»„å`
   - g GIDï¼šæŒ‡å®šç»„ID
   ```bash
   [root@core-pods-3 ~]# groupadd tg
   [root@core-pods-3 ~]# vi /etc/group
   ```

2. ä¿®æ”¹ç”¨æˆ·ç»„ï¼š`groupmod [é€‰é¡¹] ç”¨æˆ·ç»„å`
   - g GIDï¼šä¿®æ”¹ç»„ID
   - n æ–°ç»„åï¼šä¿®æ”¹ç»„å
   ```bash
   [root@core-pods-3 ~]# groupmod -n lampg tg
   [root@core-pods-3 ~]# vi /etc/group
   ```

3. åˆ é™¤ç”¨æˆ·ç»„ï¼š`groupdel ç”¨æˆ·ç»„å`ï¼Œåˆ é™¤æ—¶ç»„é‡Œä¸èƒ½æœ‰åˆå§‹ç”¨æˆ·ï¼Œå¯ä»¥æœ‰é™„åŠ ç”¨æˆ·
   ```bash
   [root@core-pods-3 ~]# groupadd tg
   [root@core-pods-3 ~]# useradd -g tg lamp
   [root@core-pods-3 ~]# useradd -G tg lamp1
   [root@core-pods-3 ~]# vi /etc/group
   [root@core-pods-3 ~]# groupdel tg
   groupdel: cannot remove the primary group of user 'lamp'
   [root@core-pods-3 ~]# userdel -r lamp
   [root@core-pods-3 ~]# groupdel tg
   ```

4. æŠŠç”¨æˆ·æ·»åŠ å…¥ç»„æˆ–ä»ç»„ä¸­åˆ é™¤ï¼š`gpasswd [é€‰é¡¹] ç»„å`
   - -a ç”¨æˆ·åï¼šæŠŠç”¨æˆ·åŠ å…¥ç»„
   - -d ç”¨æˆ·åï¼šæŠŠç”¨æˆ·ä»ç»„ä¸­åˆ é™¤
   ```bash
   [root@core-pods-3 ~]# grep "Bella" /etc/passwd
   Bella1:x:1009:1009::/home/Bella1:/bin/bash
   Bella2:x:1010:1010::/home/Bella2:/bin/bash
   Bella3:x:1011:1011::/home/Bella3:/bin/bash
   Bella4:x:1012:1012::/home/Bella4:/bin/bash
   Bella5:x:1013:1013::/home/Bella5:/bin/bash
   [root@core-pods-3 ~]# grep "Bella" /etc/group
   Bella1:x:1009:
   Bella2:x:1010:
   Bella3:x:1011:
   Bella4:x:1012:
   Bella5:x:1013:
   [root@core-pods-3 ~]# gpasswd -a Bella1 root
   Adding user Bella1 to group root
   [root@core-pods-3 ~]# grep "Bella" /etc/group
   root:x:0:kkk,Bella1
   Bella1:x:1009:
   Bella2:x:1010:
   Bella3:x:1011:
   Bella4:x:1012:
   Bella5:x:1013:
   [root@core-pods-3 ~]# gpasswd -a Bella2 root
   Adding user Bella2 to group root
   [root@core-pods-3 ~]# grep "Bella" /etc/group
   root:x:0:kkk,Bella1,Bella2
   Bella1:x:1009:
   Bella2:x:1010:
   Bella3:x:1011:
   Bella4:x:1012:
   Bella5:x:1013:
   [root@core-pods-3 ~]# gpasswd -d Bella2 root
   Removing user Bella2 from group root
   [root@core-pods-3 ~]# grep "Bella" /etc/group
   root:x:0:kkk,Bella1
   Bella1:x:1009:
   Bella2:x:1010:
   Bella3:x:1011:
   Bella4:x:1012:
   Bella5:x:1013:
   [root@core-pods-3 ~]# 
   ```
