---
title: å¯åŠ¨ç®¡ç†ï¼ˆå…„å¼Ÿè¿ï¼‰
date: 2022-08-15 14:34:43
tags:
categories:
- [å­¦ä¹ , DevOPS, å…„å¼Ÿè¿Linuxå­¦ä¹ ]
valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"
---

> æ³¨æ„ä¸‹é¢é’ˆå¯¹centos6.xçš„ï¼Œç°åœ¨centos7å’Œ8æœ‰å¾ˆå¤§çš„å˜åŒ–ï¼Œä¸‹è¿°ä»…ä¾›å‚è€ƒ

# Centos6.xå¯åŠ¨ç®¡ç†

## è¿è¡Œçº§åˆ«

1. è¿è¡Œçº§åˆ«

   |è¿è¡Œçº§åˆ«|å«ä¹‰|
   |---|---|
   |0|å…³æœº|
   |1|å•ç”¨æˆ·æ¨¡å¼ï¼Œå¯ä»¥æƒ³è±¡ä¸ºwindowsçš„å®‰å…¨æ¨¡å¼ï¼Œä¸»è¦ç”¨äºç³»ç»Ÿä¿®å¤|
   |2|ä¸å®Œå…¨çš„å‘½ä»¤è¡Œæ¨¡å¼ï¼Œä¸å«NFSæœåŠ¡ï¼ˆNFSæœåŠ¡æ˜¯linuxå’Œlinuxä¹‹é—´çš„ä¸€ä¸ªæ–‡ä»¶å…±äº«æœåŠ¡ï¼‰|
   |3|å®Œå…¨çš„å‘½ä»¤è¡Œæ¨¡å¼ï¼Œå°±æ˜¯æ ‡å‡†å­—ç¬¦ç•Œé¢ï¼Œå°±æ˜¯æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„æ¨¡å¼|
   |4|ç³»ç»Ÿä¿ç•™ï¼Œæœªä½¿ç”¨|
   |5|å›¾å½¢æ¨¡å¼|
   |6|é‡å¯åŠ¨|

2. è¿è¡Œçº§åˆ«å‘½ä»¤

   ```bash
   [root@core-pods-3 ~]# runlevel    # æŸ¥çœ‹è¿è¡Œçº§åˆ«
   N 3              # N ä»£è¡¨æˆ‘è¿›å…¥3çº§åˆ«ä¹‹å‰æ˜¯å“ªä¸ªçº§åˆ«ï¼Œè¿™é‡Œåªæˆ‘ä¸€å¼€æœºå°±è¿›å…¥ç¬¬3çº§åˆ«
   [root@core-pods-3 ~]# init 5      # æ”¹å˜è¿è¡Œçº§åˆ«ï¼Œbasic serverä¸åŒ…æ‹¬å›¾å½¢ç•Œé¢ï¼Œæ˜¯ä¸è¡Œçš„
   [root@core-pods-3 ~]# runlevel
   3 5          # ä»å­—ç¬¦ç•Œé¢3è¿›å…¥åˆ°äº†å›¾å½¢ç•Œé¢5çš„æ„æ€
   [root@core-pods-3 ~]# init 3
   [root@core-pods-3 ~]# runlevel
   5 3
   [root@core-pods-3 ~]# init 0     # å…³æœºï¼Œä¸å®‰å…¨ï¼Œä¸ä¿å­˜æ­£åœ¨è¿è¡Œçš„ç¨‹åºç›¸å…³ä¿¡æ¯
   ```

3. ç³»ç»Ÿé»˜è®¤è¿è¡Œçº§åˆ«

```bash
[root@core-pods-3 ~]# vi /etc/inittab 
id:3:initdefault:
# ç³»ç»Ÿå¼€æœºåç›´æ¥è¿›å…¥å“ªä¸ªè¿è¡Œçº§åˆ«ï¼Œinittabæ–‡ä»¶ä»centos6å¼€å§‹å°±ä¸€ç›´åœ¨å‰Šå¼±ï¼Œcentos7 inittabé‡Œé¢å·²ç»æ²¡æœ‰å†…å®¹äº†

# for centos7
# To set a default target, run:
# systemctl set-default TARGET.target
```

## ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹

![qdgl01](../../../../images/qdgl01.jpg)

### initramfså†…å­˜æ–‡ä»¶ç³»ç»Ÿ

centos6.xä¸­ä½¿ç”¨äº†initramfså†…å­˜æ–‡ä»¶ç³»ç»Ÿå–ä»£äº†centos5.xä¸­çš„initrd RAM Diskã€‚ä»–ä»¬çš„ä½œç”¨ç±»ä¼¼ï¼Œå¯ä»¥é€šè¿‡å¯åŠ¨å¼•å¯¼ç¨‹åºåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶ååŠ è½½å¯åŠ¨è¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„å†…æ ¸æ¨¡å—ï¼Œæ¯”å¦‚USBã€SATAã€SCSIç¡¬ç›˜çš„é©±åŠ¨å’ŒLVMã€RAIDæ–‡ä»¶ç³»ç»Ÿçš„é©±åŠ¨ã€‚

```bash
[root@core-pods-3 tmp]# cp /boot/initramfs-3.10.0-514.el7.x86_64.img /tmp/test
[root@core-pods-3 tmp]# cd /tmp/test/
[root@core-pods-3 test]# ls
initramfs-3.10.0-514.el7.x86_64.img
[root@core-pods-3 test]# file initramfs-3.10.0-514.el7.x86_64.img 
initramfs-3.10.0-514.el7.x86_64.img: gzip compressed data, from Unix, last modified: Thu Jul  7 03:08:06 2022, max compression
[root@core-pods-3 test]# mv initramfs-3.10.0-514.el7.x86_64.img initramfs-3.10.0-514.el7.x86_64.img.gz
[root@core-pods-3 test]# gunzip initramfs-3.10.0-514.el7.x86_64.img.gz 
[root@core-pods-3 test]# ls
initramfs-3.10.0-514.el7.x86_64.img
[root@core-pods-3 test]# file initramfs-3.10.0-514.el7.x86_64.img 
initramfs-3.10.0-514.el7.x86_64.img: ASCII cpio archive (SVR4 with no CRC)
You have new mail in /var/spool/mail/root
[root@core-pods-3 test]# cpio -ivcdu < initramfs-3.10.0-514.el7.x86_64.img 
```

### rc.sysinitåˆå§‹åŒ–

ç”±/etc/rc.d/rc.sysinitåˆå§‹åŒ–ä»¥ä¸‹å†…å®¹

1. è·å¾—ç½‘ç»œç¯å¢ƒ
2. æŒ‚è½½è®¾å¤‡
3. å¼€æœºå¯åŠ¨ç”»é¢Plymouthï¼ˆå–æ›¿äº†è¿‡å¾€çš„RHGBï¼‰
4. åˆ¤æ–­æ˜¯å¦å¯ç”¨SELinux
5. æ˜¾ç¤ºäºå¼€æœºè¿‡ç¨‹ä¸­çš„æ¬¢è¿ç”»é¢
6. åˆå§‹åŒ–ç¡¬ä»¶
7. ç”¨æˆ·è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½
8. é…ç½®å†…æ ¸çš„å‚æ•°
9. è®¾ç½®ä¸»æœºå
10. åŒæ­¥å­˜å‚¨å™¨
11. è®¾å¤‡æ˜ å°„å™¨åŠç›¸å…³çš„åˆå§‹åŒ–
12. åˆå§‹åŒ–è½¯ä»¶ç£ç›˜é˜µåˆ—ï¼ˆRAIDï¼‰
13. åˆå§‹åŒ–LVMçš„æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½
14. æ£€éªŒç£ç›˜æ–‡ä»¶ç³»ç»Ÿï¼ˆfsckï¼‰
15. è®¾ç½®ç£ç›˜é…é¢ï¼ˆquotaï¼‰
16. é‡æ–°ä»¥å¯è¯»å†™æ¨¡å¼æŒ‚è½½ç³»ç»Ÿç£ç›˜
17. æ›´æ–°quotaï¼ˆéå¿…è¦ï¼‰
18. å¯åŠ¨ç³»ç»Ÿè™šæ‹Ÿéšæœºæ•°ç”Ÿæˆå™¨
19. é…ç½®æœºå™¨ï¼ˆéå¿…è¦ï¼‰
20. æ¸…é™¤å¼€æœºè¿‡ç¨‹å½“ä¸­çš„ä¸´æ—¶æ–‡ä»¶
21. åˆ›å»ºICEç›®å½•
22. å¯åŠ¨äº¤æ¢åˆ†åŒºï¼ˆswapï¼‰
23. å°†å¼€æœºä¿¡æ¯å†™å…¥/var/log/dmesgæ–‡ä»¶ä¸­

### rcæ–‡ä»¶
è°ƒç”¨/etc/rc.d/rcæ–‡ä»¶

è¿è¡Œç•Œåˆ«å‚æ•°ä¼ å…¥`/etc/rc.d/rc`è¿™ä¸ªè„šæœ¬ä¹‹åï¼Œç”±è¿™ä¸ªè„šæœ¬æ–‡ä»¶æŒ‰ç…§ä¸åŒçš„è¿è¡Œçº§åˆ«å¯åŠ¨`/etc/rc[0-6].d/`ç›®å½•ä¸­çš„ç›¸åº”çš„ç¨‹åº
- /etc/rc3.d/k??å¼€å¤´çš„æ–‡ä»¶ï¼ˆ??æ˜¯æ•°å­—ï¼‰ï¼Œä¼šæŒ‰ç…§æ•°å­—é¡ºåºä¾æ¬¡å…³é—­ï¼Œå¯¹åº”æ“ä½œ-å…³æœº
- /etc/rc3.d/S??å¼€å¤´çš„æ–‡ä»¶ï¼ˆ??æ˜¯æ•°å­—ï¼‰ï¼Œä¼šæŒ‰ç…§æ•°å­—é¡ºåºä¾æ¬¡å¯åŠ¨ï¼Œå¯¹åº”æ“ä½œ-å¼€æœº

# å¯åŠ¨å¼•å¯¼ç¨‹åºgrub

## Grubé…ç½®æ–‡ä»¶

1. grubä¸­åˆ†åŒºè¡¨ç¤º

|ç¡¬ç›˜|åˆ†åŒº|linuxä¸­è®¾å¤‡æ–‡ä»¶å|grubä¸­è®¾å¤‡æ–‡ä»¶å|
|---|---|---|---|
|ç¬¬ä¸€å—SCSIç¡¬ç›˜|ç¬¬ä¸€ä¸ªä¸»åˆ†åŒº|/dev/sda1|hd(0,0)|
|---|ç¬¬äºŒä¸ªä¸»åˆ†åŒº|/dev/sda2|hd(0,1)|
|---|æ‰©å±•åˆ†åŒº|/dev/sda3|hd(0,2)|
|---|ç¬¬ä¸€ä¸ªé€»è¾‘åˆ†åŒº|/dev/sda5|hd(0,4)|
|ç¬¬äºŒå—SCSIç¡¬ç›˜|ç¬¬ä¸€ä¸ªä¸»åˆ†åŒº|/dev/sdb1|hd(1,0)|
|---|ç¬¬äºŒä¸ªä¸»åˆ†åŒº|/dev/sdb2|hd(1,1)|
|---|æ‰©å±•åˆ†åŒº|/dev/sdb3|hd(1,2)|
|---|ç¬¬ä¸€ä¸ªé€»è¾‘åˆ†åŒº|/dev/sdb5|hd(1,4)|

```bash
[root@core-pods-3 grub2]# ll /boot/grub2   # centos7
total 30
-rw-r--r--. 1 root root   84 Mar 13  2017 device.map
drwxr-xr-x. 2 root root 1024 Mar 13  2017 fonts
-rw-r--r--  1 root root 6877 Jul  7 03:07 grub.cfg
-rw-r--r--. 1 root root 5081 Jun 30 05:22 grub.cfg.1657177367.rpmsave
-rw-r--r--. 1 root root 1024 Jul  7 03:07 grubenv
drwxr-xr-x. 2 root root 8192 Mar 13  2017 i386-pc
drwxr-xr-x. 2 root root 1024 Mar 13  2017 locale
You have new mail in /var/spool/mail/root
```

2. grubé…ç½®æ–‡ä»¶

ç¼–è¾‘grubé…ç½®æ–‡ä»¶ï¼š`vi /boot/grub/grub.conf`

- default=0  é»˜è®¤å¯åŠ¨ç¬¬ä¸€ä¸ªç³»ç»Ÿ
- timeout=5  ç­‰å¾…æ—¶é—´ï¼Œé»˜è®¤æ˜¯5ç§’
- splashimage=(hd0,0)/grub/splash.xpm.gz  è¿™é‡Œæ˜¯æŒ‡å®šgrubå¯åŠ¨æ—¶çš„èƒŒæ™¯å›¾åƒæ–‡ä»¶çš„ä¿å­˜ä½ç½®
- hiddenmenu  éšè—èœå•
- title CentOSï¼ˆxxxxxï¼‰  æ ‡é¢˜
- root(hd0,0)  æ˜¯æŒ‡å¯åŠ¨ç¨‹åºçš„ä¿å­˜åˆ†åŒº
- kernel /vmlinuz-xxx.i686 roxxxx  å®šä¹‰å†…æ ¸åŠ è½½æ—¶çš„é€‰é¡¹
- initrd /initramfs-xxx.i686.img æŒ‡å®šäº†initramfså†…å­˜æ–‡ä»¶ç³»ç»Ÿé•œåƒæ–‡ä»¶çš„æ‰€åœ¨ä½ç½®
