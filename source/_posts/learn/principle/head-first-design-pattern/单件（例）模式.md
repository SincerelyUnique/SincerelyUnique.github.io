---
title: å•ä»¶ï¼ˆä¾‹ï¼‰æ¨¡å¼
date: 2018-01-17 15:25:50
tags:
- principle
- design pattern
categories:
- [å­¦ä¹ , è®¾è®¡æ¨¡å¼, HeadFirstè®¾è®¡æ¨¡å¼]
valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"
---

å®šä¹‰ï¼šç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚ `Head Firstè®¾è®¡æ¨¡å¼ç¬¬äº”ç« `

è¦ç‚¹ï¼š

- å•ä»¶æ¨¡å¼ç¡®ä¿ç¨‹åºä¸­ä¸€ä¸ªç±»æœ€å¤šåªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚
- å•ä»¶æ¨¡å¼ä¹Ÿæä¾›è®¿é—®è¿™ä¸ªå®ä¾‹çš„å…¨å±€ç‚¹ã€‚
- åœ¨javaä¸­å®ç°å•ä»¶æ¨¡å¼éœ€è¦ç§æœ‰çš„æ„é€ å™¨ã€ä¸€ä¸ªé™æ€æ–¹æ³•å’Œä¸€ä¸ªé™æ€å˜é‡ã€‚
- ç¡®å®šåœ¨æ€§èƒ½å’Œèµ„æºä¸Šçš„é™åˆ¶ï¼Œç„¶åå°å¿ƒåœ°é€‰æ‹©é€‚å½“çš„æ–¹æ¡ˆæ¥å®ç°å•ä»¶ï¼Œä»¥è§£å†³å¤šçº¿ç¨‹çš„é—®é¢˜ï¼ˆæˆ‘ä»¬å¿…é¡»è®¤å®šæ‰€æœ‰çš„ç¨‹åºéƒ½æ˜¯å¤šçº¿ç¨‹çš„ï¼‰ã€‚
- JDK1.4ç‰ˆæœ¬åŠä¹‹å‰ï¼ŒåŒé‡æ£€æŸ¥åŠ é”å®ç°ä¼šå¤±æ•ˆã€‚
- å¦‚æœä½¿ç”¨å¤šä¸ªç±»åŠ è½½å™¨ï¼Œå¯èƒ½å¯¼è‡´å•ä»¶å¤±æ•ˆè€Œäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚æ¯ä¸ªç±»åŠ è½½å™¨å®šä¹‰äº†ä¸€ä¸ªå‘½åç©ºé—´ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªä»¥ä¸Šï¼Œä¸åŒçš„ç±»åŠ è½½å™¨å¯èƒ½ä¼šåŠ è½½åŒä¸€ä¸ªç±»ï¼Œä»è€Œäº§ç”Ÿå¤šä¸ªå•ä»¶å¹¶å­˜çš„æ€ªå¼‚ç°è±¡ã€‚
- å¦‚æœä½¿ç”¨jvm1.2æˆ–ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä½ å¿…é¡»å»ºç«‹å•ä»¶æ³¨å†Œè¡¨ï¼Œä»¥å…åƒåœ¾æ”¶é›†å™¨å°†å•ä»¶å›æ”¶ã€‚
- é€šä¿—è®²çš„é¥¿æ±‰å¼å’Œæ‡’æ±‰å¼ï¼ŒæŒ‡çš„å°±æ˜¯å•ä»¶çš„æ€¥åˆ‡å®ä¾‹åŒ–å’Œå»¶è¿Ÿå®ä¾‹åŒ–ã€‚
- å…¨å±€å˜é‡æ¯”å•ä»¶æ¨¡å¼å·®ï¼Œå…¨å±€å˜é‡å¯èƒ½é€ æˆå‘½åç©ºé—´çš„æ±¡æŸ“ï¼Œä¸èƒ½ç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚

å•ä»¶å®ç°æ–¹å¼ä¸€ï¼šéçº¿ç¨‹å®‰å…¨

```java
package com.example.pattern.singleton;
 
/**
 * <p>
 * <code>Singleton</code>
 * </p>
 * Description: çº¿ç¨‹ä¸å®‰å…¨ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹
 *
 * @author Mcchu
 * @date 2018/1/17 14:27
 */
public class Singleton {
 
    /**
     * å•ä»¶å˜é‡
     */
    private static Singleton uniqueInstance;
 
    /**
     * å£°æ˜ç§æœ‰æ„é€ å™¨
     */
    private Singleton(){ }
 
    /**
     * å¤–éƒ¨è°ƒç”¨æ–¹æ³•
     * @return uniqueInstance
     */
    public static Singleton getInstance(){
        if ( uniqueInstance==null ){
            uniqueInstance = new Singleton();
        }
        return uniqueInstance;
    }
}
```

å•ä»¶æ¨¡å¼å®ç°æ–¹å¼äºŒï¼šçº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½ä½

```java
package com.example.pattern.singleton;
 
/**
 * <p>
 * <code>SingletonThreadSafeRepeat</code>
 * </p>
 * Description: çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯é™ä½äº†æ€§èƒ½ï¼Œå› ä¸ºåªæœ‰ç¬¬ä¸€æ¬¡åˆ›å»ºå•ä»¶æ—¶æ‰éœ€è¦åšçº¿ç¨‹æ§åˆ¶
 *
 * @author Mcchu
 * @date 2018/1/17 15:13
 */
public class SingletonThreadSafeRepeat {
 
    /**
     * å•ä»¶å˜é‡
     */
    private static SingletonThreadSafeRepeat uniqueInstance;
 
    /**
     * ç§æœ‰æ„é€ å™¨
     */
    private SingletonThreadSafeRepeat(){};
 
    /**
     * å¯¹å¤–å…¬å¼€
     * @return uniqueInstance
     */
    public static synchronized SingletonThreadSafeRepeat getInstance(){
        if ( uniqueInstance==null ){
            uniqueInstance = new SingletonThreadSafeRepeat();
        }
        return uniqueInstance;
    }
}
```

å•ä»¶æ¨¡å¼å®ç°æ–¹å¼ä¸‰ï¼šé¥¿æ±‰å¼-æ€¥åˆ‡åˆ›å»º

```java
package com.example.pattern.singleton;
 
/**
 * <p>
 * <code>SingletonThreadSafe</code>
 * </p>
 * Description: çº¿ç¨‹å®‰å…¨->ä¾èµ–jvmåœ¨åŠ è½½è¿™ä¸ªç±»æ—¶é©¬ä¸Šåˆ›å»ºæ­¤å”¯ä¸€çš„å•ä»¶å®ä¾‹
 *
 * @author Mcchu
 * @date 2018/1/17 14:47
 */
public class SingletonThreadSafe {
 
    /**
     * â€œæ€¥åˆ‡â€åˆ›å»ºå®ä¾‹ï¼ˆåˆç§°é¥¿æ±‰å¼ï¼‰ï¼Œ
     */
    private static SingletonThreadSafe uniqueInstance = new SingletonThreadSafe();
 
    /**
     * å£°æ˜ç§æœ‰æ„é€ å™¨
     */
    private SingletonThreadSafe(){}
 
    /**
     * ç›´æ¥ä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„å®ä¾‹
     * @return uniqueInstance
     */
    public static SingletonThreadSafe getInstance(){
        return uniqueInstance;
    }
}
```

å•ä»¶æ¨¡å¼å®ç°æ–¹å¼å››ï¼šåŒé‡æ£€æŸ¥åŠ é”

```java
package com.example.pattern.singleton;
 
/**
 * <p>
 * <code>SingletonDoubleLockThreadSafe</code>
 * </p>
 * Description: åŒé‡åŠ é”->double-checked lockingï¼Œçº¿ç¨‹å®‰å…¨
 *
 * @author Mcchu
 * @date 2018/1/17 14:49
 */
public class SingletonDoubleLockThreadSafe {
 
    /**
     * JDK1.4åŠæ›´æ—©ç‰ˆæœ¬ï¼ŒJCMå¯¹äºvolatileå…³é”®å­—çš„å®ç°ä¼šå¯¼è‡´åŒé‡æ£€æŸ¥åŠ é”å¤±æ•ˆï¼Œæ‰€ä»¥ä¸è¦ç”¨æ­¤æ–¹æ³•å®ç°
     */
    private volatile static SingletonDoubleLockThreadSafe uniqueInstance;
 
    /**
     * ç§æœ‰æ„é€ å™¨
     */
    private SingletonDoubleLockThreadSafe(){};
 
    public static SingletonDoubleLockThreadSafe getInstance(){
        if ( uniqueInstance==null ){
            // æ³¨æ„ï¼Œè¿™é‡Œæ˜¯åœ¨ä¸å­˜åœ¨æ—¶è¿›å…¥åŒæ­¥åŒºå—
            synchronized ( SingletonDoubleLockThreadSafe.class ){
                if ( uniqueInstance==null ){
                    uniqueInstance = new SingletonDoubleLockThreadSafe();
                }
            }
        }
        return uniqueInstance;
    }
}
```


