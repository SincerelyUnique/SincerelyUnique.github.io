---
title: javaç¼–è¯‘æ—¶ä¼˜åŒ–çš„éƒ¨åˆ†ä½“ç°
date: 2017-12-07 09:19:53
tags:
- java
categories:
- [å­¦ä¹ , Javaè¯­è¨€å­¦ä¹ , Java]
valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"
---

1. å¦‚æœä½¿ç”¨â€œ+â€å·æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œä¸”â€œ+â€å·ä¸¤è¾¹éƒ½æ˜¯å¸¸é‡ï¼Œåˆ™jvmç¼–è¯‘æ—¶åšè®¡ç®—ï¼›å¦‚æœå­˜åœ¨å˜é‡ï¼Œåˆ™åœ¨è¿è¡Œæ—¶åšè®¡ç®—ï¼›

2. ä½¿ç”¨finalä¿®é¥°çš„å˜é‡ï¼Œå¯åœ¨jvmç¼–è¯‘æ—¶åšå¤„ç†ï¼›

3. ä½¿ç”¨String.intern()åªè¦è®¿é—®çš„å¸¸é‡ç›¸åŒï¼Œä»–ä»¬å¿…ç„¶æ˜¯åŒä¸€ä¸ªï¼›

```java
/**
 * <p>
 * <code>Test</code>
 * </p>
 * Description: ã€Šjavaç‰¹ç§å…µã€‹ä¹¦ä¸­ä»£ç 
 *
 * @author Mcchu
 * @date 2017/12/5 15:57
 */
public class Test {
 
    /**
     * JVM çš„â€œç¼–è¯‘æ—¶ä¼˜åŒ–â€ï¼šå¸¸é‡
     * 1.é€šè¿‡â€œ+â€èµ‹å€¼çš„ï¼Œå¦‚æœéƒ½æ˜¯å¸¸é‡ï¼Œç”±äºJVM çš„â€œç¼–è¯‘æ—¶ä¼˜åŒ–â€ï¼Œç¼–è¯‘æ—¶ä¼šç›´æ¥å–æœ€åå€¼èµ‹äºˆå˜é‡
     * 2.é€šè¿‡â€œ+â€èµ‹å€¼çš„ï¼Œå¦‚æœåŒ…å«å˜é‡ï¼Œåˆ™åœ¨è¿è¡Œæ—¶å†è®¡ç®—
     * ç»“è®ºï¼šString çš„â€œ+â€æ“ä½œå¹¶ä¸ä¸€å®šæ¯” StringBuilder.append()æ…¢
     */
    private static void test1(){
        String a = "a"+"b"+1;     // a å¼•ç”¨æ˜¯é€šè¿‡â€œ+â€èµ‹å€¼çš„ï¼Œç”±äºJVM çš„â€œç¼–è¯‘æ—¶ä¼˜åŒ–â€ï¼Œä¼šå°†å…¶ç¼–è¯‘ä¸ºï¼šString a = "ab1"; æ­¤ä¸‰è€…éƒ½æ˜¯å¸¸é‡æ— éœ€è¿è¡Œæ—¶å†è¿›è¡Œè®¡ç®—
        String b = "ab1";         // b å¼•ç”¨æ˜¯ç›´æ¥èµ‹å€¼çš„
        System.out.println(a==b); // è¾“å‡ºtrue
 
 
        String x = "a";           // x ä¸ºå±€éƒ¨å˜é‡ï¼Œç”±äºè¿è¡Œæ—¶ä»»ä½•äº‹æƒ…éƒ½ä¼šå‘ç”Ÿï¼Œå¦‚æœå­˜åœ¨ä»£ç åˆ‡å…¥ï¼Œå°±å¯èƒ½å‘ç”Ÿæ”¹å˜
        String c = x+"b"+1;       // c å¼•ç”¨åŒ…å«å˜é‡ï¼Œç”±äºå±€éƒ¨å˜é‡çš„æ€§è´¨ï¼Œæ•…ç¼–è¯‘æ—¶æ— æ³•èµ‹å€¼
        String d = "ab1";         // d å¼•ç”¨æ˜¯ç›´æ¥èµ‹å€¼çš„
        System.out.println(c==d); // è¾“å‡ºfalse
    }
 
    /**
     * JVM çš„â€œç¼–è¯‘æ—¶ä¼˜åŒ–â€ï¼šfinalä¿®é¥°ç¬¦
     * æ³¨ï¼š
     * åœ¨ç¼–è¯‘é˜¶æ®µèƒ½ç¡®å®šçš„å†…å®¹åªèƒ½æ¥è‡ªäºå¸¸é‡æ± ä¸­ï¼Œå¦‚ intã€longã€String ç­‰å¸¸é‡ï¼Œ
     * ä¹Ÿå°±æ˜¯ä¸åŒ…å« new String()ã€new Integer()è¿™æ ·çš„æ“ä½œï¼Œä¹Ÿä¸åŒ…å«æ–¹æ³•çš„è¿”å›å€¼
     * åªæœ‰åœ¨ç¼–è¯‘é˜¶æ®µèƒ½ç¡®å®šè¿™ä¸ª final å¼•ç”¨èµ‹å€¼çš„å†…å®¹ï¼Œç¼–è¯‘å™¨æ‰æœ‰å¯èƒ½è¿›è¡Œç¼–è¯‘æ—¶ä¼˜åŒ–
     */
    private static void test2(){
        String a = "a";
        final String b = "a";//final ä¿®é¥°ç¬¦ï¼Œä»å®šä¹‰ä¸Šå¼ºåˆ¶çº¦æŸäº† c æ˜¯ä¸å…è®¸è¢«æ”¹å˜çš„ï¼Œç”±äº final ä¸å¯å˜ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨è‡ªç„¶è®¤ä¸ºç»“æœæ˜¯ä¸å¯å˜çš„
 
        String c = a + "b";
        String d = b + "b";
        String e = getA() + "b";
 
        String compare = "ab";
        System.out.println( c==compare ); // è¾“å‡ºfalse
        System.out.println( d==compare ); // è¾“å‡ºtrue
        System.out.println( e==compare ); // è¾“å‡ºfalse
    }
    private static String getA(){
        return "a";
    }
 
    /**
     * JVM çš„â€œç¼–è¯‘æ—¶ä¼˜åŒ–â€ï¼šâ€œå¸¸é‡æ± â€åŒºåŸŸå¯¹äºåŒä¸€ä¸ªå€¼çš„å­—ç¬¦ä¸²ä¿è¯å…¨å±€å”¯ä¸€
     * è°ƒç”¨ intern()æ–¹æ³•æ—¶ï¼ŒJVM ä¼šåœ¨è¿™ä¸ªå¸¸é‡æ± ä¸­é€šè¿‡ equals()æ–¹æ³•æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç­‰å€¼çš„ String
     *     å¦‚æœå­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›å¸¸é‡æ± ä¸­è¿™ä¸ª String å¯¹è±¡çš„åœ°å€ï¼›
     *     å¦‚ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºç­‰å€¼çš„å­—ç¬¦ä¸²ï¼ˆå³ç­‰å€¼çš„ char[]æ•°ç»„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ char[]æ˜¯æ–°å¼€è¾Ÿçš„ä¸€ä»½æ‹·è´ç©ºé—´ï¼‰ï¼Œç„¶åå†è¿”å›è¿™ä¸ªæ–°åˆ›å»ºç©ºé—´çš„åœ°å€ã€‚
     * åªè¦æ˜¯åŒæ ·çš„å­—ç¬¦ä¸²ï¼Œå½“è°ƒç”¨ intern()æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šå¾—åˆ°å¸¸é‡æ± ä¸­å¯¹åº” String çš„å¼•ç”¨ï¼Œæ‰€ä»¥ä¸¤ä¸ªå­—ç¬¦ä¸²é€šè¿‡ intern()æ“ä½œåç”¨ç­‰å·æ˜¯å¯ä»¥åŒ¹é…çš„ã€‚
     */
    private static void test3(){
        String a = "a";
        String b = a + "b";
        String c = "ab";
        String d = new String(b);
 
        System.out.println(b == c); // è¾“å‡ºfalse
        System.out.println(c == d); // è¾“å‡ºfalse
        System.out.println(c == d.intern()); // è¾“å‡ºtrue
        System.out.println(b.intern() == d.intern()); // è¾“å‡ºtrue
    }
 
    public static void main(String[] args) {
        System.out.println("æµ‹è¯•ä¸€ï¼š");
        test1();
 
        System.out.println();
        System.out.println("æµ‹è¯•äºŒï¼š");
        test2();
 
        System.out.println();
        System.out.println("æµ‹è¯•ä¸‰ï¼š");
        test3();
    }
}
```

è¾“å‡ºç»“æœï¼š

```
æµ‹è¯•ä¸€ï¼š
true
false
 
æµ‹è¯•äºŒï¼š
false
true
false
 
æµ‹è¯•ä¸‰ï¼š
false
false
true
true
```
